# with filtered delly sv

/home/hirschc1/qiuxx221/widiv/de_novo/download_sample/test_merge_sv

ls *vcf > sample_files


~/programs/SURVIVOR-master/Debug/SURVIVOR merge sample_files 1000 2 1 1 0 25 sample_merged.vcf
~/programs/SURVIVOR-master/Debug/SURVIVOR vcftobed sample_merged.vcf 25 1000000 sample_merged.bed

awk '{if ($1=="chr1" && $4=="chr1"){print}}' sample_merged.bed |  awk '{if ($5-$3>=25 || $3-$5>=25){print}}' | awk '{if ($6-$2<=1000000 ||$2-$6<=1000000 ){print}}' | cut -f 1,2,6 > merged_sv_call_chr1.bed
# total calls 
7170

bedtools intersect -a anchorwave_B97_B73_chr1_25_1000000.bed -b ~/widiv/de_novo/download_sample/test_merge_sv/merged_sv_call.bed  -f 0.8 -r -wa -wb| wc -l
# total 3137 # 3133 uniq call 




# when don't require type 
~/programs/SURVIVOR-master/Debug/SURVIVOR merge sample_files 1000 2 0 1 0 25 sample_merged_no_type_restriction.vcf

~/programs/SURVIVOR-master/Debug/SURVIVOR vcftobed sample_merged_no_type_restriction.vcf 25 1000000 sample_merged_no_type_restriction.bed

awk '{if ($1=="chr1" && $4=="chr1"){print}}' sample_merged_no_type_restriction.bed |  awk '{if ($5-$3>=25 || $3-$5>=25){print}}' | awk '{if ($6-$2<=1000000 ||$2-$6<=1000000 ){print}}' | cut -f 1,2,6 > merged_sv_sample_merged_no_type_restriction.bed
# 7216 

bedtools intersect -a anchorwave_B97_B73_chr1_25_1000000.bed -b ~/widiv/de_novo/download_sample/test_merge_sv/merged_sv_sample_merged_no_type_restriction.bed  -f 0.8 -r -wa -wb| wc -l
