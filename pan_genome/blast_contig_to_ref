
blastn -db ~/widiv/B73_index/Zm-B73-REFERENCE-NAM-5.0.fasta -query xaa_merged.fasta -perc_identity 75 -outfmt 6 -out results.out

# creating file that include the contig length info 

cat xaa_blast_results.out > xaa_blast_results_fmt.out; cut -f 1 xaa_blast_results.out | sed 's|_|\t|g' > cat_sequence_header_split ; paste cat_sequence_header_split xaa_blast_results_fmt.out | awk -F" " '$21=($16-$15)/$4'  |awk '(NR>0) && ($21 >= 0.75 )' | cut -d ' ' -f 9-21 | head


## xaa
# blast to NR for filtering

awk '!seen[$1]++' xaa_diamond_blastnr.out > xaa_best_diamond_blastnr.out


cd /scratch.global/qiuxx221/blast_to_nr

for i in `cat best_acession_xaa.txt`; do 
    printf ${i}"\t"; \
    efetch -db protein -id ${i} -format xml \
    | xtract -pattern Seq-entry -element Org-ref_taxname, OrgName_lineage, NCBIeaa, Textseq-id_accession ;
done > SummaryTable_xaa.tsv
